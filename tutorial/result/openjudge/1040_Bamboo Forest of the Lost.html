<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - 1040:Bamboo Forest of the Lost</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://poj.openjudge.cn/"><img class="group-logo" src="http://media.openjudge.cn/groups/2/logo_small.jpg" alt="PKU Online Judge" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://poj.openjudge.cn/" title="首页" rel="home">PKU Online Judge</a></h2>
		 <span>/</span>
		 <h2>练习</h2>
			</div>
    <ul id="mainNav">
        <li  class="current"><a href="/practice/" class="first">题目</a></li>
            <li ><a href="/practice/ranking/">排名</a></li>
                    <li ><a href="/practice/status/">状态</a></li>
	    			        <li class="last"><a href="/practice/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>1040:Bamboo Forest of the Lost</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/practice/1040/">查看</a></li>
		<li ><a href="/practice/1040/submit/">提交</a></li>
				<li ><a href="/practice/1040/statistics/">统计</a></li>
			
		<li ><a href="/practice/clarify/1040/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>1000ms</dd>
			<dt>内存限制: </dt>
		<dd>65536kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><p>The bamboo forest is a magical place in Gensokyo. People always get lost in this forest because it changes frequently.</p><p>You are lost in this forest now. Fortunately, you met Mokou, who lives here. She told you that the bamboo forest consists of n areas (numbered from 1 to n) and m directed paths. Each area is switching its state circularly in a sequence of k states, and it switches to the next state (or to the first state if the current state is the last one in the sequence) after every one unit of time. The number of different states among all n areas is sk, and they are numbered from 1 to sk.</p><p>People will also lose energy in the bamboo forest. In area i, it consumes you c(i) units of energy to stay in area i for a unit time. The energy consumed when you go through path e is floor(w(e)×f(p(u,i),p(v,j))), where p(u,i) is the state of the start point u when you leave u; and p(v,j) is the state of the end point v when you arrive at v. The time consumed when you go through path e is d(e).</p><p>Now you are at area 1 of the forest. The exit of the forest is at area n. The current time is 0. All areas are at the first state in the sequence now. Please calculate the minimal energy needed to get to the exit.</p><p>Notice that all times are integers, and you cannot stay in an area for a non-integer time interval. We ensure that there is at least one path from area 1 to area n.</p></dd>
				
				
				<dt>输入</dt>
		<dd>The first line contains an integer T (1 ≤ T ≤ 10) -- the number of test cases.<br /><br />For each test case:<br />The first line contains four integers: n, m, k, sk. 1 ≤ n ≤ 10 000, 1 ≤ m ≤ 100 000, 1 ≤ k ≤ 10, 1 ≤ sk ≤ 20.<br />Then follows n lines, each line contains (k+1) integers. The first integer is c(i) (1 ≤ c(i) ≤ 1 000); following k integers make up the state sequence for area i.<br />For next sk lines, each line contains sk real numbers. The j-th number on the i-th line is f(i,j). 1 ≤ f(i,j) ≤ 7.<br />And next m lines, each line contains 4 integers: u, v, w, d. They represent a directed path from area u to area v with value w and value d. 1 ≤ u,v ≤ n, 1 ≤ w ≤ 1000, 1 ≤ d ≤ 16.</dd>
		<dt>输出</dt>
		<dd>For each test case, output an integer in a single line, which is the minimal energy needed to get to the exit.</dd>
		<dt>样例输入</dt>
		<dd><pre>1
4 5 3 3
4 1 2 3
3 1 3 2
2 2 3 2
5 3 1 3
5.0 3.0 1.0
3.0 1.0 3.0
1.0 3.0 5.0
1 2 5 2
1 3 8 3
2 3 4 1
2 4 7 3
3 4 6 2
</pre></dd>
		<dt>样例输出</dt>
		<dd><pre>25</pre></dd>
						</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/practice/1040/">查看</a></li>
		<li ><a href="/practice/1040/submit/">提交</a></li>
				<li ><a href="/practice/1040/statistics/">统计</a></li>
			
		<li ><a href="/practice/clarify/1040/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       		<dl>
		<dt>全局题号</dt>
		<dd>5896</dd>
					<dt>添加于</dt>
			<dd>2013-05-12</dd>
				<dt>提交次数</dt>
		<dd>129</dd>
		<dt>尝试人数</dt>
	    <dd>24</dd>
	    <dt>通过人数</dt>
	    <dd>17</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li><a href="http://poj.openjudge.cn//history.html" rel="nofollow">历届出题人名单</a></li>
						<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
