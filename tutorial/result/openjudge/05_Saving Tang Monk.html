<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - 05:Saving Tang Monk</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://icpcsummer.openjudge.cn/"><img class="group-logo" src="http://static.openjudge.cn/images/default_logo_small.png" alt="北京大学ACM/ICPC竞赛训练暑期课" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://icpcsummer.openjudge.cn/" title="首页" rel="home">北京大学ACM/ICPC竞赛训练暑期课</a></h2>
		 <span>/</span>
		 <h2>北京大学ACM/ICPC竞赛训练暑期课练习</h2>
		<span style="font-size:14px;">已经结束</span>	</div>
    <ul id="mainNav">
        <li  class="current"><a href="/pkuacmtrain/" class="first">题目</a></li>
            <li ><a href="/pkuacmtrain/ranking/">排名</a></li>
                    <li ><a href="/pkuacmtrain/status/">状态</a></li>
	     
        <li ><a href="/pkuacmtrain/statistics/">统计</a></li>
				        <li class="last"><a href="/pkuacmtrain/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>05:Saving Tang Monk</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/pkuacmtrain/05/">查看</a></li>
		<li ><a href="/pkuacmtrain/05/submit/">提交</a></li>
				<li ><a href="/pkuacmtrain/05/statistics/">统计</a></li>
			
		<li ><a href="/pkuacmtrain/clarify/05/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>1000ms</dd>
			<dt>内存限制: </dt>
		<dd>65536kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><p class="MsoNormal" style="">《<span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">Journey to theWest</span>》<span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">(also </span>《<span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">Monkey</span>》<span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">) is one of the </span><span><a href="http://en.wikipedia.org/wiki/Four_Great_Classical_Novels" title="Four Great Classical Novels"><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;;color:windowtext">Four Great Classical Novels</span></a></span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">of </span><span><a href="http://en.wikipedia.org/wiki/Chinese_literature" title="Chinese literature"><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;;color:windowtext">Chinese literature</span></a></span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">. It was writtenby Wu Cheng&#39;en during the Ming Dynasty. In this novel, Monkey King Sun Wukong,pig Zhu Bajie and Sha Wujing, </span><span><a href="http://cn.bing.com/dict/search?q=escort&amp;FORM=BDVSP6"><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;;color:windowtext">escort</span></a></span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">ed Tang Monk to India to getsacred Buddhism texts. </span></p><p class="MsoNormal" style=""><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">During thejourney, Tang Monk was often captured by demons. Most of demons wanted to eatTang Monk to achieve immortality, but some female demons just wanted to marryhim because he was handsome. So, fighting demons and saving Monk Tang is themajor job for Sun Wukong to do.</span></p><p class="MsoNormal" style=""><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">Once, TangMonk was captured by the demon White Bones. White Bones lived in a palace andshe cuffed Tang Monk in a room. Sun Wukong managed to get into the palace. Butto rescue Tang Monk, Sun Wukong might need to get some keys and kill some snakesin his way. </span></p><p class="MsoNormal" style=""><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">The palace can be described as a matrix of characters. Each characterstands for a room. In the matrix, &#39;K&#39; represents the original position of SunWukong, &#39;T&#39; represents the location of Tang Monk and &#39;S&#39; stands for a room witha </span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">snake</span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">in it. Please note that there are only one &#39;K&#39; and one &#39;T&#39;, and at mostfive </span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">snakes</span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">in the palace. And, &#39;.&#39; means a clear room as well &#39;#&#39; means a deadlyroom which Sun Wukong couldn&#39;t get in. </span></p><p class="MsoNormal" style=""><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">There may be some keys of different kinds scattered in the rooms, butthere is at most one key in one room. There are at most 9 kinds of keys. A roomwith a key in it is represented by a digit(from &#39;1&#39; to &#39;9&#39;). For example, &#39;1&#39;means a room with a first kind key, &#39;2&#39; means a room with a second kind key,&#39;3&#39; means a room with a third kind key... etc. To save Tang Monk, Sun Wukongmust get ALL kinds of keys(in other words, at least one key for each kind). </span></p><p class="MsoNormal" style=""><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;"> For each step, Sun Wukong could moveto the adjacent rooms(except deadly rooms) in 4 directions(north,west,south andeast), and each step took him one minute. If he entered a room in which a living</span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">snake</span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">stayed, he must kill the </span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">snake</span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">. Killinga </span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">snake</span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">also took one minute. <span style="color:red">If Sun Wukong entered aroom where there is a key of kind N, Sun would get that key if and only if hehad already got keys of kind 1,kind 2 ... and kind N-1.</span>In other words,Sun Wukong must get a key of kind N before he could get a key of kind N+1 (N&gt;=1).If Sun Wukong got all keys he needed and entered the room in which Tang Monkwas </span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">cuffed</span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">, the rescue mission is completed. If Sun Wukong didn&#39;t get enough keys,he still could pass through Tang Monk&#39;s room. </span><span style="font-family:&#39;Cambria&#39;,&#39;serif&#39;">Since Sun Wukong was a impatient monkey,he wanted to save Tang Monk as quickly as possible. Please figure out theminimum time Sun Wukong needed to rescue Tang Monk.</span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;<br /></p></dd>
				
				
				<dt>输入</dt>
		<dd>There are several test cases.<br />For each case, the first line includes two integers N and M(0 < N <= 100, 0<=M<=9), meaning that the palace is a N * N matrix and Sun Wukong needed M kinds of keys(kind 1, kind 2, ... kind M). <br />Then the N*N matrix follows.<br />The input ends with N = 0 and M = 0.</dd>
		<dt>输出</dt>
		<dd>For each test case, print the minimum time (in minute) Sun Wokong needed to save Tang Monk. If it's impossible for Sun Wokong to complete the mission, print "impossible".</dd>
		<dt>样例输入</dt>
		<dd><pre>3 1
K.S
##1
1#T
3 1
K#T
.S#
1#.
3 2
K#T
.S.
21.
0 0
</pre></dd>
		<dt>样例输出</dt>
		<dd><pre>5
impossible
8
</pre></dd>
						<dt>来源</dt>
		<dd>Guo Wei</dd>
				</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/pkuacmtrain/05/">查看</a></li>
		<li ><a href="/pkuacmtrain/05/submit/">提交</a></li>
				<li ><a href="/pkuacmtrain/05/statistics/">统计</a></li>
			
		<li ><a href="/pkuacmtrain/clarify/05/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       		<dl>
		<dt>全局题号</dt>
		<dd>8523</dd>
				<dt>提交次数</dt>
		<dd>136</dd>
		<dt>尝试人数</dt>
	    <dd>32</dd>
	    <dt>通过人数</dt>
	    <dd>29</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
