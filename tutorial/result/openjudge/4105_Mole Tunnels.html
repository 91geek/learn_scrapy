<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - 4105:Mole Tunnels</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://pkuteam.openjudge.cn/"><img class="group-logo" src="http://media.openjudge.cn/groups/7/logo_small.jpg" alt="北京大学ACM-ICPC竞赛队" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://pkuteam.openjudge.cn/" title="首页" rel="home">北京大学ACM-ICPC竞赛队</a></h2>
		 <span>/</span>
		 <h2>ICPC竞技编程练习</h2>
			</div>
    <ul id="mainNav">
        <li  class="current"><a href="/icpc/" class="first">题目</a></li>
            <li ><a href="/icpc/ranking/">排名</a></li>
                    <li ><a href="/icpc/status/">状态</a></li>
	    			        <li class="last"><a href="/icpc/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>4105:Mole Tunnels</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/icpc/4105/">查看</a></li>
		<li ><a href="/icpc/4105/submit/">提交</a></li>
				<li ><a href="/icpc/4105/statistics/">统计</a></li>
			
		<li ><a href="/icpc/clarify/4105/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>10000ms</dd>
			<dt>单个测试点时间限制: </dt>
		<dd>2000ms</dd>
			<dt>内存限制: </dt>
		<dd>256000kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><p>Moles create tunnels for traveling between their holes. In this problem we investigate one tunnel system that was built by moles. It consists of n holes and n-1 tunnels connecting them. Let us number all holes from 1 to n. Then for all i &gt; 1, a hole number i is connected by a tunnel to the hole number ⌊i/2⌋. Tunnels are bidirectional. For each hole i we know the <em>amount of food</em> c<sub>i</sub> in that hole. It means that there is enough food for exactly c<sub>i</sub> moles in that hole.</p><p>There are m moles living in the tunnel system. For each mole i you are given an integer p<sub>i</sub> — the hole number where the mole i is currently sleeping. In the morning, the first k moles wake up and want to eat, while m-k others are sleeping. Each of k woken up moles chooses some hole and crawls to it. They are quite smart, so they want to minimize the total distance traveled. The distance traveled by one mole is the total number of tunnels which it uses to get from one hole to another. The first k moles who woke up want to move in such a way, so that there is enough food for them at the holes they choose to crawl to. It means that in the hole i there are no more than c<sub>i</sub> woken up moles after all their movements are done.</p><p>You must find the minimum total distance for all k from 1 to m. It is guaranteed that there always exists a way for all moles to eat.</p></dd>
				
				
				<dt>输入</dt>
		<dd>The first line contains two integers n and m (1 ≤ n,m ≤ 10<sup>5</sup>) — the number of holes and moles. The second line contains n integers ci (0 ≤ c<sub>i</sub> ≤ m) — the amount of food in the hole i. The third line contains m integers pi (1 ≤ p<sub>i</sub> ≤ n) — the starting positions of the moles.</dd>
		<dt>输出</dt>
		<dd>You must print m numbers. The k-th number is the minimum total distance the first k moles need to travel if they woke up first.</dd>
		<dt>样例输入</dt>
		<dd><pre>5 4
0 0 4 1 1
2 4 5 2</pre></dd>
		<dt>样例输出</dt>
		<dd><pre>1 1 2 4</pre></dd>
				<dt>提示</dt>
		<dd><div align="center"><img src="http://media.openjudge.cn/images/upload/1502044087.png" width="100%" /></div><br />Dashed arrows in the above pictures show possible travel of woken up moles that minimizes the total distance. For example, for k = 2 the first mole goes from the hole 2 to the hole 5 and the second mole stays in the hole 4.</dd>
						<dt>来源</dt>
		<dd>NEERC 2016</dd>
				</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/icpc/4105/">查看</a></li>
		<li ><a href="/icpc/4105/submit/">提交</a></li>
				<li ><a href="/icpc/4105/statistics/">统计</a></li>
			
		<li ><a href="/icpc/clarify/4105/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       		<dl>
		<dt>全局题号</dt>
		<dd>15764</dd>
					<dt>添加于</dt>
			<dd>2017-08-07</dd>
				<dt>提交次数</dt>
		<dd>1</dd>
		<dt>尝试人数</dt>
	    <dd>1</dd>
	    <dt>通过人数</dt>
	    <dd>1</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
