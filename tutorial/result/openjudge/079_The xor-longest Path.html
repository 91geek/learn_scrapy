<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - 079:The xor-longest Path</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://cqyz.openjudge.cn/"><img class="group-logo" src="http://static.openjudge.cn/images/default_logo_small.png" alt="ITer openjudge" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://cqyz.openjudge.cn/" title="首页" rel="home">ITer openjudge</a></h2>
		 <span>/</span>
		 <h2>【综合训练】</h2>
			</div>
    <ul id="mainNav">
        <li  class="current"><a href="/zonghe/" class="first">题目</a></li>
            <li ><a href="/zonghe/ranking/">排名</a></li>
                    <li ><a href="/zonghe/status/">状态</a></li>
	    			        <li class="last"><a href="/zonghe/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>079:The xor-longest Path</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/zonghe/079/">查看</a></li>
		<li ><a href="/zonghe/079/submit/">提交</a></li>
				<li ><a href="/zonghe/079/statistics/">统计</a></li>
			
		<li ><a href="/zonghe/clarify/079/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>2000ms</dd>
			<dt>内存限制: </dt>
		<dd>65536kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><div><p>In an edge-weighted tree, the xor-length of a path <em>p</em>is defined as the xor sum of the weights of edges on <em>p</em>:</p><p style=";text-align:center;"><img src="http://media.openjudge.cn/images/2975.gif" /></p><p>⊕ is the xor operator.</p><p>We say a path the xor-longest path if it has the largest xor-length. Given an edge-weighted tree with n nodes, can you find the xor-longest path? 　</p></div></dd>
				
				
				<dt>输入</dt>
		<dd><div><p>The input contains several test cases. The first line of each test case contains an integer <i>n</i>(1<=<i>n</i><=100000), The following <i>n</i>-1 lines each contains three integers <i>u</i>(0 <= <i>u</i> < <i>n</i>),<i>v</i>(0 <= <i>v</i> < <i>n</i>),<i>w</i>(0 <= <i>w</i> < 2^31), which means there is an edge between node <i>u</i> and <i>v</i> of length <i>w</i>. </p></div></dd>
		<dt>输出</dt>
		<dd>For each test case output the xor-length of the xor-longest path.</dd>
		<dt>样例输入</dt>
		<dd><pre>4
0 1 3
1 2 4
1 3 6
</pre></dd>
		<dt>样例输出</dt>
		<dd><pre>7</pre></dd>
				<dt>提示</dt>
		<dd><div><p>The xor-longest path is 0->1->2, which has length 7 (=3 ⊕ 4) </p></div><br /><pre><br />#include < algorithm ><br />#include < cstdio ><br />#include < cstring ><br />#include < vector ><br />using namespace std;<br /><br />const int MAXN = 100010;<br />const int MAXM = 200010;<br />struct Trie {<br />	Trie *children[2];<br />	int value;<br />} root, pool[MAXN << 5], *ptr, emptyNode;<br />// Trie树是一棵二叉树，左孩子表示当前二进制位为0，右孩子表示当前二进制位为1<br />// 叶子节点额外保存value，表示当前路径对应的数，如根-左-右-右这个节点的value为(011)2=3<br /><br />int n;<br />// 节点个数<br /><br />int head[MAXN], succeed[MAXM], vertex[MAXM], weight[MAXM], now;<br />// head,succeed使用链表保存边表；vertex,weight存每条边的终点以及权值<br /><br />int rootXor[MAXN];<br />// 每个点到根的路径的xor值<br /><br />void addEdge(int u, int v, int w) {<br />	// 往链表中添加一条u->v，权值为w的边<br />	________(1)________<br />	// 新的节点的后继为u节点原来的链表头<br />	vertex[now] = v;<br />	// 新的边的终点为v<br />	weight[now] = w;<br />	// 新的边的权值为w<br />	head[u] = now++;<br />	// 指定u节点新的链表头为now<br />}<br /><br />void readTree() {<br />	// 读入树<br />	memset(head, -1, sizeof head);<br />	now = 0;<br />	for (int i = 0; i < n - 1; i++) {<br />		int u, v, w;<br />		scanf("%d%d%d", &u, &v, &w);<br />		addEdge(u, v, w);<br />		addEdge(v, u, w);<br />	}<br />}<br /><br />void DFS(int x = 0, int father = -1) {<br />	// DFS求出每个点到0号点的路径的xor值，并填到rootXor数组中<br />	// 参数x表示当前递归到的节点，father表示当前点的父亲<br />	for (int now = head[x]; now != -1; now = succeed[now]) {<br />		// 遍历x节点的链表，找到所有x的出边<br />		int y = vertex[now];<br />		int w = weight[now];<br />		// 从x到y有一条权值为w的边<br />		if (________(2)________)<br />			continue;<br />		// 忽略返回父亲的边<br />		rootXor[y] = ________(3)________;<br />		// 计算rootXor[y]的值，为y到0号点的路径的xor值<br />		DFS(y, x);<br />	}<br />}<br /><br />int getNthBit(int value, int nBit) {<br />	return value >> nBit & 1;<br />}<br /><br />void insertTrie(Trie *node, int value, int nBit) {<br />	// 往Trie中插入value<br />	// 当前在node这个节点，处理到value的第nBit个bit<br />	// 如果nBit为-1，说明已经处理完毕，node为叶子节点<br />	if (nBit == -1)<br />		node->value = ________(4)________;<br />	else {<br />		bool bit = ________(5)________;<br />		// bit为0说明当前的节点应为node的左孩子<br />		// bit为1说明当前的节点应为node的右孩子<br />		if (!node->children[bit]) {<br />			node->children[bit] = ptr++;<br />			*node->children[bit] = emptyNode;<br />		}<br />		insertTrie(node->children[bit], value, nBit - 1);<br />	}<br />}<br /><br />void buildTrie() {<br />	// 将所有rootXor[i]插入Trie中<br />	root = emptyNode;<br />	ptr = pool;<br />	for (int i = 0; i < n; i++)<br />		insertTrie(&root, rootXor[i], 30);<br />}<br /><br />int queryTrie(Trie *node, int value, int nBit) {<br />	// 在Trie中查询与value的xor值最大的答案<br />	// 当前在node这个节点，处理到value的第nBit个bit<br />	// 如果nBit为-1，说明已经处理完毕，node为叶子节点<br />	if (nBit == -1)<br />		return node->value ^ value;<br />	else {<br />		bool bit = ________(5)________;<br />		// 同上<br />		if (node->children[!bit])<br />			return queryTrie(node->children[!bit], value, nBit - 1);<br />		else<br />			return queryTrie(node->children[bit], value, nBit - 1);<br />	}<br />}<br /><br />int getAns() {<br />	// 将所有rootXor[i]在Trie中查询最大的xor答案<br />	int ans = 0;<br />	for (int i = 0; i < n; i++)<br />		ans = max(ans, queryTrie(&root, rootXor[i], 30));<br />	return ans;<br />}<br /><br />int main() {<br />	while (scanf("%d", &n) == 1) {<br />		readTree();<br />		DFS();<br />		buildTrie();<br />		printf("%d\n", getAns());<br />	}<br />	return 0;<br />}<br /></pre></dd>
						</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/zonghe/079/">查看</a></li>
		<li ><a href="/zonghe/079/submit/">提交</a></li>
				<li ><a href="/zonghe/079/statistics/">统计</a></li>
			
		<li ><a href="/zonghe/clarify/079/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       		<dl>
		<dt>全局题号</dt>
		<dd>2975</dd>
					<dt>添加于</dt>
			<dd>2016-05-31</dd>
				<dt>提交次数</dt>
		<dd>8</dd>
		<dt>尝试人数</dt>
	    <dd>2</dd>
	    <dt>通过人数</dt>
	    <dd>2</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
