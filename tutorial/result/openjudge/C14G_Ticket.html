<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - C14G:Ticket</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://poj.openjudge.cn/"><img class="group-logo" src="http://media.openjudge.cn/groups/2/logo_small.jpg" alt="PKU Online Judge" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://poj.openjudge.cn/" title="首页" rel="home">PKU Online Judge</a></h2>
		 <span>/</span>
		 <h2>练习</h2>
			</div>
    <ul id="mainNav">
        <li  class="current"><a href="/practice/" class="first">题目</a></li>
            <li ><a href="/practice/ranking/">排名</a></li>
                    <li ><a href="/practice/status/">状态</a></li>
	    			        <li class="last"><a href="/practice/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>C14G:Ticket</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/practice/C14G/">查看</a></li>
		<li ><a href="/practice/C14G/submit/">提交</a></li>
				<li ><a href="/practice/C14G/statistics/">统计</a></li>
			
		<li ><a href="/practice/clarify/C14G/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>3000ms</dd>
			<dt>内存限制: </dt>
		<dd>65536kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><p>The n cities (numbered from 0 to n-1) in your province are connected by m single-lane roads. Each road is labeled with an integer. You may obtain a ticket, return a ticket or do nothing if you are driving on a road. More specifically, when driving along a road started from city x to city y with label t, you will<br />1. Receive a ticket with a t-th type of stamp before you hit the road if t &gt; 0;<br />2. Be allowed to drive freely on the road if t = 0;<br />3. Be asked to return a specified ticket before you hit the road if t &lt; 0. That ticket should be the most recently obtained ticket in your hands which is marked with a t-th type of stamp.</p><p>For example, you are allowed to drive along a sequence of roads labelled with 1 2 0 -2 -1 1. However, you are not allowed to drive along the roads labelled with 1 2 0 -1 -2 1. For the first example, you will have only one ticket in your hands when finishing the 6th road. For the second example, you are not allowed to drive on the 4th road because you cannot return the ticket with a 1st type of stamp because that ticket in your hands is not the most recently obtained one.</p><p>You are planning to test your newly purchased car on the road in the province. You can depart from any city and end your journey in any city. You do not have any ticket before the journey. You may have several tickets with the same type during the journey. The length of your journey is d, that is to say, you need to pass exactly d roads.</p><p>Your task is to calculate the number of different paths of your journey. In this task, a path is defined as a sequence of roads you are allowed to drive. Since the answer will be extremely large, you need to output the reminder of the answer divided by 32 768, i.e. the result of “answer mod 32 768”.<br /></p><p><br /></p></dd>
				
				
				<dt>输入</dt>
		<dd>The first line contains an integer T (1 ≤ T ≤ 10) -- the number of test cases.<br /><br />For each test case:<br />The first line contains three integers n, m, d. 1 ≤ n ≤ 25, 1 ≤ m ≤ 200, 1 ≤ d ≤ 35.<br />Then follows m lines, each line contains three integers: x, y, t, indicate that there is a road from city x to city y with label t. 0 ≤ x, y < n, -10 ≤ t ≤ 10.</dd>
		<dt>输出</dt>
		<dd>For each test case, output one integer in a single line -- the number of different paths, modulo 32 768.</dd>
		<dt>样例输入</dt>
		<dd><pre>1
3 5 5
0 1 2
1 1 1
1 2 0
2 0 -1
2 0 -2
</pre></dd>
		<dt>样例输出</dt>
		<dd><pre>12</pre></dd>
				<dt>提示</dt>
		<dd>Twelve different paths for the sample are: (each path is represented by a sequence of passing cities during the journey)<br /><br />0, 1, 1, 1, 1, 1<br />0, 1, 1, 1, 1, 2<br />0, 1, 1, 1, 2, 0<br />0, 1, 1, 2, 0, 1<br />0, 1, 2, 0, 1, 1<br />0, 1, 2, 0, 1, 2<br />1, 1, 1, 1, 1, 1<br />1, 1, 1, 1, 1, 2<br />1, 1, 1, 1, 2, 0<br />1, 1, 1, 2, 0, 1<br />1, 1, 2, 0, 1, 1<br />1, 1, 2, 0, 1, 2</dd>
						</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/practice/C14G/">查看</a></li>
		<li ><a href="/practice/C14G/submit/">提交</a></li>
				<li ><a href="/practice/C14G/statistics/">统计</a></li>
			
		<li ><a href="/practice/clarify/C14G/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       		<dl>
		<dt>全局题号</dt>
		<dd>7025</dd>
					<dt>添加于</dt>
			<dd>2014-05-10</dd>
				<dt>提交次数</dt>
		<dd>93</dd>
		<dt>尝试人数</dt>
	    <dd>19</dd>
	    <dt>通过人数</dt>
	    <dd>11</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li><a href="http://poj.openjudge.cn//history.html" rel="nofollow">历届出题人名单</a></li>
						<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
