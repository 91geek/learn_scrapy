<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - 4092:Voting</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://pkuteam.openjudge.cn/"><img class="group-logo" src="http://media.openjudge.cn/groups/7/logo_small.jpg" alt="北京大学ACM-ICPC竞赛队" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://pkuteam.openjudge.cn/" title="首页" rel="home">北京大学ACM-ICPC竞赛队</a></h2>
		 <span>/</span>
		 <h2>ICPC竞技编程练习</h2>
			</div>
    <ul id="mainNav">
        <li  class="current"><a href="/icpc/" class="first">题目</a></li>
            <li ><a href="/icpc/ranking/">排名</a></li>
                    <li ><a href="/icpc/status/">状态</a></li>
	    			        <li class="last"><a href="/icpc/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>4092:Voting</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/icpc/4092/">查看</a></li>
		<li ><a href="/icpc/4092/submit/">提交</a></li>
				<li ><a href="/icpc/4092/statistics/">统计</a></li>
			
		<li ><a href="/icpc/clarify/4092/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>1000ms</dd>
			<dt>内存限制: </dt>
		<dd>512000kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><p>In Berland presidential elections occurs by a complex multilevel hierarchical system. The opposition believes that this electoral system was invented to confuse the public and to conceal the unfairness of voting. This year one candidate from the opposition is running for president. If he wins, there would be a real opportunity to change the political situation. The simplest representation of the voting system is a rooted tree. Leaves of this tree correspond to individual voters. Each internal node is an oﬃcial social group of some kind (family, home, neighborhood, district, etc.). Children of a node correspond to the entities that directly belong to this oﬃcial social group: individual voters and/or other groups. The root node of the tree is the group including all the citizens of Berland. Each of the voters may either vote for a particular candidate or refrain from voting, for example, by not coming to the election. After every voter has voted one way or another, for each group the local election results are determined, in order from smaller to larger groups. To do this, the votes of all children entities of this group are considered. A candidate wins in the local election if he receives strictly more votes than any other candidate. If there is no such winning candidate, then the local election has failed. Further, the results of voting in the group are taken into account in the local voting on the next level as a single vote from the whole group. If there was no winner in local election, the group is considered “abstained”, and its opinion is not taken into account any further. A candidate who has won in the local election of the highest group (i.e. in the tree’s root) becomes Berland’s President. If there is no election winner in this group, then the position of the president in Berland is abolished until the next election. For each individual voter it is known for whom he is going to vote. The opposition can change the preference for any voter in any way desired, but it requires some eﬀort. It is necessary to determine the minimum number of voters whose opinions are to be changed in order for the opposition candidate to become the president.</p></dd>
				
				
				<dt>输入</dt>
		<dd>The first line of the input file contains integers N, M, K, where N is number of individual voters, M is number of social groups and K is number of candidates (2 ≤ N ≤ 5000, 1 ≤ M ≤ 5000, 2 ≤ K ≤ 3). Voters, groups and candidates are individually numbered starting from one. The number of the opposition candidate is 1. The second line contains N integers corresponding to initial voters’ opinions. Opinion is either equal to the number of the candidate for whom the voter intends to vote, or to zero, if he abstains from voting. The following M lines describe social groups. The t-th of the lines describes entities that belong to the social group t. It starts with a positive integer St, which is the number of these entities, followed by a space-separated list of St integers which deﬁne these entities (2 ≤ St ≤ 20). If an entity is an individual voter, his number is given. If it is a group, then its number with a minus sign is given. The group at the tree’s root, which contains all the citizens of Berland, always has number 1.</dd>
		<dt>输出</dt>
		<dd>The first line should contain a single integer R equal to the minimum number of voters whose plans need to be changed for the victory. In each of the following R lines, two integers a and v must be written, where a is the number of the voter, whose plans need to be changed, and v is either the number of the candidate for whom this voter should vote, or 0 if the voter should not come to the election. If the opposition candidate wins without any changes, the output file should contain a single number 0.<br /><br /><b><big>样例输入</big></b><br /><small>&nbsp;</small><br /><pre>8 4 3<br />2 0 2 1 1 3 2 1<br />3 -2 -3 8<br />2 1 3<br />2 -4 2<br />4 4 7 5 6<br /></pre><br /><b><big>样例输出</big></b><br /><small>&nbsp;</small><br /><pre>0</pre></dd>
		<dt>样例输入</dt>
		<dd><pre>8 4 3
2 1 2 3 3 1 2 3
3 -2 -3 8
2 1 3
2 -4 2
4 4 7 5 6</pre></dd>
		<dt>样例输出</dt>
		<dd><pre>2
5 1
8 1</pre></dd>
				<dt>提示</dt>
		<dd>The voting tree and the proposed changes for the second example are shown on the picture below. Letters a, b, c denote votes for candidates 1, 2, 3 respectively. The question mark denotes an “abstained” vote.<br /><br /><img align="center" src="http://media.openjudge.cn/images/upload/1470789859.png" width="640" /></dd>
						<dt>来源</dt>
		<dd>XVI Open Cup, Stage 6, Grand Prix of Siberia, Division 1</dd>
				</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/icpc/4092/">查看</a></li>
		<li ><a href="/icpc/4092/submit/">提交</a></li>
				<li ><a href="/icpc/4092/statistics/">统计</a></li>
			
		<li ><a href="/icpc/clarify/4092/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       		<dl>
		<dt>全局题号</dt>
		<dd>11142</dd>
					<dt>添加于</dt>
			<dd>2017-07-26</dd>
				<dt>提交次数</dt>
		<dd>0</dd>
		<dt>尝试人数</dt>
	    <dd>0</dd>
	    <dt>通过人数</dt>
	    <dd>0</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
