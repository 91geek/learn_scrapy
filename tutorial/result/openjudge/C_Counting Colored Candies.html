<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - C:Counting Colored Candies</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://poj.openjudge.cn/"><img class="group-logo" src="http://media.openjudge.cn/groups/2/logo_small.jpg" alt="PKU Online Judge" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://poj.openjudge.cn/" title="首页" rel="home">PKU Online Judge</a></h2>
		 <span>/</span>
		 <h2>PKU Campus 2016</h2>
		<span style="font-size:14px;">已经结束</span>	</div>
    <ul id="mainNav">
        <li  class="current"><a href="/campus2016/" class="first">题目</a></li>
            <li ><a href="/campus2016/ranking/">排名</a></li>
                    <li ><a href="/campus2016/status/">状态</a></li>
	     
        <li ><a href="/campus2016/statistics/">统计</a></li>
		 
        <li ><a href="/campus2016/print/">打印</a></li>
			        <li class="last"><a href="/campus2016/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>C:Counting Colored Candies</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/campus2016/C/">查看</a></li>
		<li ><a href="/campus2016/C/submit/">提交</a></li>
				<li ><a href="/campus2016/C/statistics/">统计</a></li>
			
		<li ><a href="/campus2016/clarify/C/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>1000ms</dd>
			<dt>内存限制: </dt>
		<dd>262144kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><p>You own a candy factory. In the factory, there are 10 machines, numbered from 0 to 9. Your factory can produce C colors (numbered from 1 to C) of candies.</p><p>The first step of processing candies is pouring the material into one machine to produce candies. Then follows zero or more steps. On each step, the candies produced on the previous step will be processed by any one of the machines to produce another kind of candies. The processing sequence of machines&#39; numbers (including the one on the first step) is marked as the <span style="white-space: normal;">&#39;&#39;</span>stamp&#39;&#39; of the candies. Because Machine 0 does not have a pouring entry, the leading digit of a stamp should not be <span style="white-space: normal;">&#39;&#39;</span>0&#39;&#39;. So the stamp of every candy should be a positive integer. For example, the candies with stamp <span style="white-space: normal;">&#39;&#39;</span>132&#39;&#39; indicate that they are orderly processed by machine sequence 1, 3, and 2.</p><p>The candy processing follows two types of rules:</p><ol style="list-style-type: decimal;"><li><p>Material will become candies with Color x through Machine m;</p></li><li><p>Candies with Color x<sub>0 </sub>will become candies with Color x through Machine m.</p></li></ol><p>Attention:</p><ol style="list-style-type: decimal;"><li><p>There are no contradictory rules;</p></li><li><p>If there is no rule identifying the color of candies produced by processing material/candies with Color x<sub>0</sub>on Machine m, such kind of process operation is illegal.</p></li></ol><p>You wonder that, for each Color x (x=1,2,...,C), how many kinds of candies with color x which have stamps between A and B (including A and B). 
</p></dd>
				
				
				<dt>输入</dt>
		<dd>The first line contains an integer T (1 ≤ T ≤ 15), indicating the number of test cases.<br />			<br />For each test case:<br />			<br />The first line contains two integers A and B (1 ≤ A ≤ B ≤ 10^1000), indicating the interval of stamps of candies;<br />			<br />The second line contains an integer C (1 ≤ C ≤ 1000), indicating the number of different colors;<br />			<br />The next line contains an integer N1 (1 ≤ N1 ≤ 9), indicating the number of rules of the first type. Then follows N1 lines, each line contains two integers m (1 ≤ m ≤ 9) and x (1 ≤ x ≤ C), indicating that material will become candies with Color x through Machine m;<br />			<br />The next line contains an integer N2 (1 ≤ N2 ≤ 10,000), indicating the number of rules of the second type. Then follows N2 lines, each line contains three integers x0 (1 ≤ x0 ≤ C), m (0 ≤ m ≤ 9) and x (1 ≤ x ≤ C), indicating that candies with Color x0 will become candies with Color x through Machine m.</dd>
		<dt>输出</dt>
		<dd>For each test case:<br />			<br />Output C lines. The i-th line contains an integer indicating the number of kinds of candies with color i which have stamps between A and B, modulo 20160508.</dd>
		<dt>样例输入</dt>
		<dd><pre>2
2 10
2
5
1 1
2 2
5 2
7 1
9 1
1
1 0 2
10 129
3
2
1 2 
2 1
7
1 1 1
1 2 2
1 3 2
2 0 3
2 1 3
2 2 1
2 4 3</pre></dd>
		<dt>样例输出</dt>
		<dd><pre>2
3
3
4
3</pre></dd>
				<dt>提示</dt>
		<dd>For the second test case in the Sample Output, candies that have stamps between 10 and 129 are listed below (each kind of candies is represented by their stamp):<br /><br />Candies with Color 1: 12, 21, 121;<br /><br />Candies with Color 2: 22, 23, 122, 123;<br /><br />Candies with Color 3: 10, 11, 14.</dd>
						</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/campus2016/C/">查看</a></li>
		<li ><a href="/campus2016/C/submit/">提交</a></li>
				<li ><a href="/campus2016/C/statistics/">统计</a></li>
			
		<li ><a href="/campus2016/clarify/C/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       	<p class="notification">Balloon Color<br />
 A - Light Green<br />
 B - Light Purple<br />
 C - Green<br />
 D - Purple<br />
 E - Yellow<br />
 F - Pink<br />
 G - Blue<br />
 H - Light Blue<br />
 I - Orange<br />
 J - Red</p>
			<dl>
		<dt>全局题号</dt>
		<dd>10075</dd>
				<dt>提交次数</dt>
		<dd>179</dd>
		<dt>尝试人数</dt>
	    <dd>74</dd>
	    <dt>通过人数</dt>
	    <dd>42</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li><a href="http://poj.openjudge.cn//history.html" rel="nofollow">历届出题人名单</a></li>
						<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
