<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - 4065:Wizards and Bets</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://pkuteam.openjudge.cn/"><img class="group-logo" src="http://media.openjudge.cn/groups/7/logo_small.jpg" alt="北京大学ACM-ICPC竞赛队" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://pkuteam.openjudge.cn/" title="首页" rel="home">北京大学ACM-ICPC竞赛队</a></h2>
		 <span>/</span>
		 <h2>ICPC竞技编程练习</h2>
			</div>
    <ul id="mainNav">
        <li  class="current"><a href="/icpc/" class="first">题目</a></li>
            <li ><a href="/icpc/ranking/">排名</a></li>
                    <li ><a href="/icpc/status/">状态</a></li>
	    			        <li class="last"><a href="/icpc/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>4065:Wizards and Bets</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/icpc/4065/">查看</a></li>
		<li ><a href="/icpc/4065/submit/">提交</a></li>
				<li ><a href="/icpc/4065/statistics/">统计</a></li>
			
		<li ><a href="/icpc/clarify/4065/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>24000ms</dd>
			<dt>单个测试点时间限制: </dt>
		<dd>3000ms</dd>
			<dt>内存限制: </dt>
		<dd>256000kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><p style="text-align: justify;">In some country live wizards. They like to make weird bets.<br /><br />Two wizards draw an acyclic directed graph with n vertices and m edges (the graph&#39;s vertices are numbered from 1 to n). A source is a vertex with no incoming edges, and a sink is the vertex with no outgoing edges. Note that a vertex could be the sink and the source simultaneously. In the wizards&#39; graph the number of the sinks and the sources is the same.<br /><br />Wizards numbered the sources in the order of increasing numbers of the vertices from 1 to k. The sinks are numbered from 1 to k in the similar way.<br /><br />To make a bet, they, as are real wizards, cast a spell, which selects a set of k paths from all sources to the sinks in such a way that no two paths intersect at the vertices. In this case, each sink has exactly one path going to it from exactly one source. Let&#39;s suppose that the i-th sink has a path going to it from the a<sub>i</sub>&#39;s source. Then let&#39;s call pair (i, j) an inversion if i &lt; j and a<sub>i</sub> &gt; a<sub>j</sub>. If the number of inversions among all possible pairs (i, j), such that (1 ≤ i &lt; j ≤ k), is even, then the first wizard wins (the second one gives him one magic coin). Otherwise, the second wizard wins (he gets one magic coin from the first one).<br /><br />Our wizards are captured with feverish excitement, so they kept choosing new paths again and again for so long that eventually they have chosen every possible set of paths for exactly once. The two sets of non-intersecting pathes are considered to be different, if and only if there is an edge, which lies at some path in one set and doesn&#39;t lie at any path of another set. To check their notes, they asked you to count the total winnings of the first player for all possible sets of paths modulo a prime number p.<br /><br /><br /></p></dd>
				
				
				<dt>输入</dt>
		<dd>The first line contains three space-separated integers n, m, p (1 ≤ n ≤ 600, 0 ≤ m ≤ 10<sup>5</sup>, 2 ≤ p ≤ 10<sup>9</sup> + 7). It is guaranteed that p is prime number.<br /><br />Next m lines contain edges of the graph. Each line contains a pair of space-separated integers, a<sub>i</sub> b<sub>i</sub> — an edge from vertex a<sub>i</sub> to vertex b<sub>i</sub>. It is guaranteed that the graph is acyclic and that the graph contains the same number of sources and sinks. Please note that the graph can have multiple edges.</dd>
		<dt>输出</dt>
		<dd>Print the answer to the problem — the total winnings of the first player modulo a prime number p. Please note that the winnings may be negative, but the modulo residue must be non-negative (see the sample).</dd>
		<dt>样例输入</dt>
		<dd><pre>4 2 1000003
1 3
2 4</pre></dd>
		<dt>样例输出</dt>
		<dd><pre>1</pre></dd>
				<dt>提示</dt>
		<dd><b>Sample Input (2)</b><br /><pre>4 2 1000003<br />4 1<br />3 2</pre><br /><b>Sample Output (2)</b><br /><pre>1000002</pre><br /><br /><b>Sample Input (3)</b><br /><pre>4 4 1000003<br />2 1<br />2 4<br />3 1<br />3 4</pre><br /><b>Sample Output (3)</b><br /><pre>0</pre><br /><br /><b>Sample Input (4)</b><br /><pre>6 5 1000003<br />1 4<br />1 5<br />1 6<br />2 6<br />3 6</pre><br /><b>Sample Output (4)</b><br /><pre>0</pre><br /><br /><b>Sample Input (5)</b><br /><pre>5 2 1000003<br />5 1<br />3 4</pre><br /><b>Sample Output (5)</b><br /><pre>1</pre><br /><br />In the first sample, there is exactly one set of paths — (1→3), (2→4). The number of inversions is 0, which is an even number. Therefore, the first wizard gets 1 coin.<br /><br />In the second sample there is exactly one set of paths — (4→1), (3→2). There is exactly one inversion. Therefore, the first wizard gets -1 coin. -1 mod (10<sup>6</sup>+3) = 10<sup>6</sup> + 2.<br /><br />In the third sample, there are two sets of paths, which are counted with opposite signs.<br /><br />In the fourth sample there are no set of paths at all.<br /><br />In the fifth sample, there are three sources — the vertices with the numbers (2, 3, 5) and three sinks — the vertices with numbers (1, 2, 4). For a single set of paths (5→1), (3→4), (2→2) are 2 inversions, that is, their number is <b>even</b>.<br /><br /><span style="color:red">WARNING: this problem from <a href="http://codeforces.com">codeforces.com</a> is for Summer 2013 Practice Sessions at PKU only.</span><br />Codeforces materials usage license (v. 0.1)<br /><ol><br /><li>You may publish the texts of Codeforces problems in any open sources, but you must preserve a direct link to the site <a href="http://codeforces.ru">http://codeforces.ru</a> (<a href="http://codeforces.com">http://codeforces.com</a> for English statements) and indicate Codeforces as the problem source. These data should be located in the close proximity to the statement, be easily noticeable and readable. It is forbidden to publish Codeforces problems in open sources supporting automatic testing (such as online judges or similar resources).<br /><li>You must not use tests and other materials of the problems (generators, checkers, validators) to publish tasks in open sources supporting automatic testing (such as online judges or similar resources) even provided the original problem conditions has been changed.<br /><li>You may use the provided material: tests, generators, checkers, validators and others for individual training or to organize short-term teaching and training activities with the participants present on-site. Task conditions should contain the data from paragraph 1 of this license. The secondary (subsequent) distribution of the tasks should contain this license and comply fully with the license’s rules.<br /></ol></dd>
						</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/icpc/4065/">查看</a></li>
		<li ><a href="/icpc/4065/submit/">提交</a></li>
				<li ><a href="/icpc/4065/statistics/">统计</a></li>
			
		<li ><a href="/icpc/clarify/4065/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       		<dl>
		<dt>全局题号</dt>
		<dd>6073</dd>
					<dt>添加于</dt>
			<dd>2017-07-26</dd>
				<dt>提交次数</dt>
		<dd>0</dd>
		<dt>尝试人数</dt>
	    <dd>0</dd>
	    <dt>通过人数</dt>
	    <dd>0</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
