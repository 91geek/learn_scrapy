<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - 4089:Archipelago Tour</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://pkuteam.openjudge.cn/"><img class="group-logo" src="http://media.openjudge.cn/groups/7/logo_small.jpg" alt="北京大学ACM-ICPC竞赛队" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://pkuteam.openjudge.cn/" title="首页" rel="home">北京大学ACM-ICPC竞赛队</a></h2>
		 <span>/</span>
		 <h2>ICPC竞技编程练习</h2>
			</div>
    <ul id="mainNav">
        <li  class="current"><a href="/icpc/" class="first">题目</a></li>
            <li ><a href="/icpc/ranking/">排名</a></li>
                    <li ><a href="/icpc/status/">状态</a></li>
	    			        <li class="last"><a href="/icpc/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>4089:Archipelago Tour</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/icpc/4089/">查看</a></li>
		<li ><a href="/icpc/4089/submit/">提交</a></li>
				<li ><a href="/icpc/4089/statistics/">统计</a></li>
			
		<li ><a href="/icpc/clarify/4089/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>4000ms</dd>
			<dt>内存限制: </dt>
		<dd>512000kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><p>Recently, Yudachi has got a map of an archipelago. The archipelago consists of one big land and many small lands. There’s a village on each small land and several villages on the big land. The government of the archipelago built some roads around the big land. Each road connects two different villages. These roads and villages on the big land form a “circle”. That means you can start from a village and return to it by visiting each road and each of other villages exactly once. Some other roads were also built between two villages on different lands. All the lands, including big and small ones, together with the roads between different lands form a “tree” (&quot;tree&quot; is a conception in graph theory). Due to the environmental condition of the roads, Yudachi find some roads safe and the others dangerous. Each road on the big land is safe, as well as some well-designed roads between different lands.</p><p>Yudachi is planning to take a tour of the archipelago now. After reading the introductions of each village on the Internet, she defined a “tour index” of each village, which is an integer evaluating the worth of a visit. She will choose a village as her departure point, travel along the roads without visiting a village twice, and finally end in an arbitrary village except the starting one. The end village can&#39;t be the starting village. The safety index of her tour will be the number of safe roads minus the number of dangerous roads, while the happiness index of her tour will be the median “tour index” of all the villages visited. E.g. If she visited villages V<sub>1</sub>, V<sub>2</sub>… V<sub>k</sub>, and the “tour index” of them are T<sub>1</sub>, T<sub>2</sub>… T<sub>k</sub> respectively, the median would be T<sub>k/2+1</sub> after T<sub>1</sub>, T<sub>2</sub>… T<sub>k</sub> were sorted in ascending order. Help Yudachi to find a maximum happiness index tour route under the condition that the safety index of her tour is no less than L and no more than R.</p></dd>
				
				
				<dt>输入</dt>
		<dd>The input includes several test cases.<br /><br />For each case, the 1st line includes 3 integers N (1<=N<=20000), L and R (1<=L<=R<=N), representing the number of the villages, and the L, R in the descriptions above.<br /><br />The 2nd line includes N integers T<sub>1</sub>, T<sub>2</sub>… T<sub>N</sub> (1<=T<sub>i</sub><=32768), representing the “tour index” of village 1, 2… N, respectively.<br /><br />Each of the 3rd to N+2th lines includes 3 integers X, Y (1<=X, Y<=N, X≠Y) and Z (Z=0 or 1), representing a road between villages X and Y. If Z=0, the road is safe. Otherwise it's dangerous. There is at most one road between two certain villages.<br /><br />An integer N=0 represents the end of the input.<br /><br />The sum of all the Ns in the input is no more than 80000.</dd>
		<dt>输出</dt>
		<dd>For each test case in the input, output an integer representing the maximum happiness index of a tour Yudachi can take. If she cannot take a tour under given conditions, the happiness will be 0.</dd>
		<dt>样例输入</dt>
		<dd><pre>5 2 3
1 10 9 7 8
1 4 0
1 2 0
2 3 1
2 4 0
3 5 0
10 2 5
5 3 3 6 3 2 7 5 3 9
4 10 0
1 2 0
2 3 1
3 4 1
2 5 0
2 6 1
4 7 0
6 8 1
7 9 1
7 10 0
0</pre></dd>
		<dt>样例输出</dt>
		<dd><pre>8
7</pre></dd>
						<dt>来源</dt>
		<dd>ACM-ICPC Asia Beijing 2015</dd>
				</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/icpc/4089/">查看</a></li>
		<li ><a href="/icpc/4089/submit/">提交</a></li>
				<li ><a href="/icpc/4089/statistics/">统计</a></li>
			
		<li ><a href="/icpc/clarify/4089/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       		<dl>
		<dt>全局题号</dt>
		<dd>11140</dd>
					<dt>添加于</dt>
			<dd>2017-07-26</dd>
				<dt>提交次数</dt>
		<dd>0</dd>
		<dt>尝试人数</dt>
	    <dd>0</dd>
	    <dt>通过人数</dt>
	    <dd>0</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
