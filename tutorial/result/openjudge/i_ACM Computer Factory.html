<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>OpenJudge - i:ACM Computer Factory</title>

<link href="http://static.openjudge.cn/styles/global.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/styles.css?1470100812.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/group.css?1468143560.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/contest.css?1467854438.css" media="screen" rel="stylesheet" type="text/css" />
<link href="http://static.openjudge.cn/styles/favicon.ico?1467854438.ico" rel="shortcut icon" type="image/x-icon" />
<!--[if IE]>
   <script type="text/javascript" src="http://static.openjudge.cn/scripts/html5.js?1467854438.js"></script>
<![endif]-->
<!--[if lt IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie6-deprecated.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 7]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie7.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
	<link type="text/css" href="http://static.openjudge.cn/styles/ie8.css?1467854438.css" rel="stylesheet" />
<![endif]-->
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery-1.4.3.min.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/jquery.form.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/base-nc.js?1467854438.js"></script>
<script type="text/javascript" src="http://static.openjudge.cn/scripts/api.js?1467854438.js"></script>
<script type="text/javascript">
    //<![CDATA[
var web_root = '/',
	static_root = 'http://static.openjudge.cn/',
	script_root = 'http://static.openjudge.cn/scripts',
	style_root = 'http://static.openjudge.cn/styles';
    //]]>
</script></head>
<body>
	<div id="headerTop">
  <div class="wrapper">
    <h1 class="logo"><a href="http://openjudge.cn/" title="首页" rel="home">OpenJudge</a></h1>
    <ul id="userToolbar">
            <li><a class="link" href="/auth/login/">登入</a></li>
      <li><a class="link" href="/register/">注册</a></li>
          </ul>
    <div class="practice-search">
		 <form class="search-form" action="/search/" method="get">
	        <input name="q" type="text" value="题目ID, 标题, 描述" onclick="this.select()">
	        <button type="submit"></button>
	     </form>	
	</div>
    <div style="clear:both;"></div>
  </div>
</div>
	
	<div id="header">
  <div class="wrapper">
  	<div id="groupSmallLog">
  		<a href="http://icpcsummer.openjudge.cn/"><img class="group-logo" src="http://static.openjudge.cn/images/default_logo_small.png" alt="北京大学ACM/ICPC竞赛训练暑期课" width="50" height="50" /></a>    </div>
	<div class="contest-title-tab">
		 <h2><a href="http://icpcsummer.openjudge.cn/" title="首页" rel="home">北京大学ACM/ICPC竞赛训练暑期课</a></h2>
		 <span>/</span>
		 <h2>2018 ACM/ICPC竞赛训练暑期课期末考试</h2>
		<span style="font-size:14px;">已经结束</span>	</div>
    <ul id="mainNav">
        <li  class="current"><a href="/2018acmicpcexam/" class="first">题目</a></li>
            <li ><a href="/2018acmicpcexam/ranking/">排名</a></li>
                    <li ><a href="/2018acmicpcexam/status/">状态</a></li>
	     
        <li ><a href="/2018acmicpcexam/statistics/">统计</a></li>
				        <li class="last"><a href="/2018acmicpcexam/clarify/" class="last">提问</a></li>
        </ul>	 
    <div style="clear:both;"></div>
  </div>
</div>	
	<div id="pagebody">
		<div class="wrapper">
			<script type="text/javascript">
$(function(e){
  var b={1:"很水",2:"简单",3:"普通",4:"较难",5:"变态"},
      g=$("#rate"),
      c=$("#stars img"),
      d=function(f){
        var h=0||g.val();
        c.each(function(k){
          var i=this.src.replace(/\w*\.gif$/,((k<f)?"sth":((k<h)?"st":"nst"))+".gif");
          this.src=i;
        });
        if(f)
          $("#rate_description").text(b[f]);
        else
          $("#rate_description").text(h!=0?b[h]:"");
      };
      c.hover(function(){d(this.id.charAt(4));},function(){d();});
      if(g.attr("value")){
        c.click(function(){
          var f=this.id.charAt(4);
          g.val(f);
          d(f);
          //$('#form_diffculity_rating').submit();
          $( "#dialog-form" ).dialog( "open" );
			g();
        });
      }
      d();
  });
$(document).ready(
		function(){
			$('#problem-tags').hide();
			$('#tag-display').toggle(function() {
											$('#problem-tags').show();
											this.value = '隐藏标签';
										}, function(){
											$('#problem-tags').hide();
											this.value = '显示标签';
										}
									);
			});
</script>

<div id="pageTitle"><h2>i:ACM Computer Factory</h2></div>
<div id="topMenu">
	<ul>
		<li class="current-show"><a href="/2018acmicpcexam/i/">查看</a></li>
		<li ><a href="/2018acmicpcexam/i/submit/">提交</a></li>
				<li ><a href="/2018acmicpcexam/i/statistics/">统计</a></li>
			
		<li ><a href="/2018acmicpcexam/clarify/i/">提问</a></li>
			
	</ul>
</div><div class="problem-page col-9">
	<dl class="problem-params">
		<dt>总时间限制: </dt>
		<dd>1000ms</dd>
			<dt>内存限制: </dt>
		<dd>65536kB</dd>
	</dl>
	<dl class="problem-content">
		<dt>描述</dt>
		<dd><p>As you know, all the computers used for ACM contests must be identical, so the participants compete on equal terms. That is why all these computers are historically produced at the same factory.</p><p>Every ACM computer consists of P parts. When all these parts are present, the computer is ready and can be shipped to one of the numerous ACM contests.</p><p>Computer manufacturing is fully automated by using <em>N</em>various machines. Each machine removes some parts from a half-finished computer and adds some new parts (removing of parts is sometimes necessary as the parts cannot be added to a computer in arbitrary order). Each machine is described by its performance (measured in computers per hour), input and output specification.</p><p>Input specification describes which parts must be present in a half-finished computer for the machine to be able to operate on it. The specification is a set of <em>P</em>numbers 0, 1 or 2 (one number for each part), where 0 means that corresponding part must not be present, 1 — the part is required, 2 — presence of the part doesn&#39;t matter.</p><p>Output specification describes the result of the operation, and is a set of <em>P</em>numbers 0 or 1, where 0 means that the part is absent, 1 — the part is present.</p><p>The machines are connected by very fast production lines so that delivery time is negligibly small compared to production time.</p><p>After many years of operation the overall performance of the ACM Computer Factory became insufficient for satisfying the growing contest needs. That is why ACM directorate decided to upgrade the factory.</p><p>As different machines were installed in different time periods, they were often not optimally connected to the existing factory machines. It was noted that the easiest way to upgrade the factory is to rearrange production lines. ACM directorate decided to entrust you with solving this problem.</p></dd>
				
				
				<dt>输入</dt>
		<dd><p>Input file contains integers <i>P</i> <i>N</i>, then <i>N</i> descriptions of the machines. The description of <i>i</i>th machine is represented as by 2 <i>P</i> + 1 integers <i>Q<sub>i</sub></i> <i>S<sub>i</sub></i><sub>,1</sub> <i>Si</i><sub>,2</sub>...<i>S<sub>i</sub></i><sub>,<i>P</i></sub> <i>D<sub>i</sub></i><sub>,1</sub> <i>D<sub>i</sub></i><sub>,2</sub>...<i>D<sub>i</sub></i><sub>,<i>P</i></sub>, where <i>Q<sub>i</sub></i> specifies performance, <i>S<sub>i</sub></i><sub>,<i>j</i></sub> — input specification for part <i>j</i>, <i>D<sub>i</sub></i><sub>,<i>k</i></sub> — output specification for part <i>k</i>.</p><p><b>Constraints</b></p><p>1 ≤ <i>P</i> ≤ 10, 1 ≤ <i>N </i>≤ 50, 1 ≤ <i>Q<sub>i</sub></i> ≤ 10000 </p></dd>
		<dt>输出</dt>
		<dd><p>Output the maximum possible overall performance, then <i>M</i> — number of connections that must be made, then <i>M</i> descriptions of the connections. Each connection between machines <i>A</i> and <i>B</i> must be described by three positive numbers <i>A</i> <i>B</i> <i>W</i>, where <i>W</i> is the number of computers delivered from <i>A</i> to <i>B</i> per hour.</p><p>If several solutions exist, output any of them.</p></dd>
		<dt>样例输入</dt>
		<dd><pre><b>Sample input 1</b>
3 4
15  0 0 0  0 1 0
10  0 0 0  0 1 1
30  0 1 2  1 1 1
3   0 2 1  1 1 1
<b>Sample input 2</b>
3 5
5   0 0 0  0 1 0
100 0 1 0  1 0 1
3   0 1 0  1 1 0
1   1 0 1  1 1 0
300 1 1 2  1 1 1
<b>Sample input 3</b>
2 2
100  0 0  1 0
200  0 1  1 1</pre></dd>
		<dt>样例输出</dt>
		<dd><pre><b>Sample output 1</b>
25 2
1 3 15
2 3 10
<b>Sample output 2</b>
4 5
1 3 3
3 5 3
1 2 1
2 4 1
4 5 1
<b>Sample output 3</b>
0 0</pre></dd>
				<dt>提示</dt>
		<dd>Bold texts appearing in the sample sections are informative and do not form part of the actual data.</dd>
						<dt>来源</dt>
		<dd>Northeastern Europe 2005, Far-Eastern Subregion</dd>
				</dl>
	<ul class="bottomMenu">
		<li class="current-show"><a href="/2018acmicpcexam/i/">查看</a></li>
		<li ><a href="/2018acmicpcexam/i/submit/">提交</a></li>
				<li ><a href="/2018acmicpcexam/i/statistics/">统计</a></li>
			
		<li ><a href="/2018acmicpcexam/clarify/i/">提问</a></li>
			</ul>
</div>

<div class="problem-statistics col-3">
       		<dl>
		<dt>全局题号</dt>
		<dd>2188</dd>
				<dt>提交次数</dt>
		<dd>27</dd>
		<dt>尝试人数</dt>
	    <dd>19</dd>
	    <dt>通过人数</dt>
	    <dd>18</dd>
	</dl>
		
		
					
	</div>
		</div>
	</div>
	<div id="footer">
	<div class="wrapper">
		<ul class="oj-info">
			<li>&copy;2002-2013 POJ 沪ICP备12005590号-3</li>
		</ul>
		<ul class="debug-info">
									<li>
				<a style="color:red" href="javascript:void(0);" onclick="api.switchLanguage('en_US');">English</a></li>
						<li><a href="http://openjudge.cn/help.html" rel="nofollow">帮助</a></li>
			<li><a href="http://openjudge.cn/about.html" rel="nofollow">关于</a></li>
		</ul>
		<div style="clear:both;"></div>
	</div>
</div>

	
	</body>
</html>
